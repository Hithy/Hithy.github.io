<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>无线网络升级 - ya0db9&#39;s Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="keywords" content="">
  <link rel="canonical" href="http://home.ya0db9.com/post/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E5%8D%87%E7%BA%A7/">

  
  

  
  

  
  

  <link rel="stylesheet" type="text/css" href="http://home.ya0db9.com//css/combined-min.css">
  <link rel="stylesheet" type="text/css" href="http://home.ya0db9.com//tipuesearch/tipuesearch.css">

</head>
<body class="">

<div class="site-wrap">
  <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://home.ya0db9.com/" class="site-title">ya0db9&#39;s Site</a>
      <nav class="site-nav right">
      <a href="http://home.ya0db9.com//about/">About</a>
<a href="http://home.ya0db9.com//tags/">Tags</a>
<a href="http://home.ya0db9.com//contact/">Contact</a>
<form class="navbar-search" action="http://home.ya0db9.com//search/index.html"
    onsubmit="return validateForm(this.elements['q'].value);">
    <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input">

</form>

      </nav>
      <div class="clearfix"></div>
    </div>
  </div>
</header>

  <div class="post p2 p-responsive wrap" role="main">
    <div class="measure">
      <div class="post-header mb2">
        <h1 class="py2">无线网络升级</h1>
        <span class="post-meta">Feb 29, 2020 </span><br>
        
      </div>

      <article class="post-content">
      
<h3 id="headline-1">
0x00 现有问题
</h3>
<p>
现有的网络，是从弱电箱的软路由拉了一根网线到卧室，接交换机到极路由(用于ap)和pc。带来两个问题：
</p>
<ol>
<li>
<p>
老的极路由只有百兆上联接口，跑不满宽带，而且被魔改过，配ap模式麻烦，导致连上的无线设备跟软路由、pc不在一个网段
</p>
</li>
<li>
<p>
因为第一个问题的存在，需要一个千兆交换机，保证pc千兆网，这样会占用两个电源接口。只要有一个接在插排上，就无法实现插排断电时候还有wifi
</p>
</li>
</ol>
<p>
其实要解决问题也很简单，买个千兆无线路由器就好了(120块钱的k2p+AP模式)
</p>
<p>
但是从实用的角度看，买个无线路由器就有点浪费了，路由功能用不上。我的需求其实是一个千兆无线交换机，但是市面上似乎很少有这种东西，所以把目光放到了独立的ap上面
</p>
<h3 id="headline-2">
0x01 初步方案
</h3>
<p>
初步方案，poe交换机+无线ap
</p>
<ol>
<li>
<p>
poe解决电源口不够问题
</p>
</li>
<li>
<p>
独立的ap，将来有大房子后(不知道啥时候)，也可以用来组ac+ap
</p>
</li>
</ol>
<p>
poe交换机比较简单，水星的8口也不算贵，京东买就好了
</p>
<p>
ap的话，最初选择是tp一个两百多块钱的1700Mbps新款。但是在跟胡会长一顿分析之后，还是觉得tp的稳定性不太靠谱，放弃了。看来看去，最后发现了uap ac pro
</p>
<p>
看上这个主要还是有几点：
</p>
<ol>
<li>
<p>
用了都说稳
</p>
</li>
<li>
<p>
官方支持全平台ac
</p>
</li>
<li>
<p>
前面的文章也提到过之前折腾ubnt的erx路由器，总体体验良好
</p>
</li>
</ol>
<p>
ubnt唯一的问题：价格
</p>
<p>
解决价格的问题的办法也比较简单：咸鱼
</p>
<p>
于是上咸鱼买了价格最低的一个uap-ac-pro，结果嘛自然是：翻车
</p>
<p>
退了之后，选了一个比最低价高了30块钱的，这回没问题了，ap和poe交换机到齐
</p>
<h3 id="headline-3">
0x02 软件
</h3>
<p>
ubnt的软件体验挺好的，界面做得很漂亮，全平台支持，这里也没什么好说的，跟着官方说明走就好了，没遇到什么问题，手机、笔记本都顺利连上了。手机上初步测试，局域网下载速度60+MB/s
</p>
<h3 id="headline-4">
0x03 测试
</h3>
<p>
uap-ac-pro的5g频率支持最大1300mbps的速率，也就是3根5g天线的速度，于是翻出了箱底的 <strong>伪-PCE-AC88</strong> (实际上是tp的WDN8280，但是跟pce-ac88的方案一样，驱动都可以互用)，4根天线。
</p>
<p>
但是上来就遇到了麻烦：
</p>
<ol>
<li>
<p>
连不上
</p>
<p>
8280连其他无线网没有问题，就是连不上ap，而手机和笔记本连ap却没有问题。想着这俩要是不兼容就麻烦了，不过几轮Google下来，发现原来是8280支持的信道问题，把ap的信道改了之后就好了
</p>
</li>
<li>
<p>
掺水的1300mbps
</p>
<p>
信道问题解决之后，适配器的状态直接就是显示1.3g了，于是开始用nas下文件测试。但是不管用什么协议(http、smb、ssh)，速度最多只能到70MB/s左右。
</p>
<p>
一开始我怀疑是cpu性能不行，因为cpu单核占用已经70%了，于是让手机、笔记本和pc同时从nas拷文件，但是从nas接口监控看到，速度最高也就600mbps(用网线可以跑满千兆)。
</p>
<p>
又是一轮Google，发现这个速度是正常的，无线协议是半双工的，一半的带宽需要用于纠错，所以实际的速度也就1.3g的一半。不得不说这帮厂商真是厚颜无耻，宣传1700M(2.4g+5g)的无线路由器，实际上也就只能跑60MB/s。
</p>
</li>
</ol>
<h3 id="headline-5">
0x04 回顾
</h3>
<p>
   后来注意到uap-ac-pro实际上是有两个有线网口的，主口的用于上联及poe供电口，副口桥接于主口。也就是说，这个ap就是个两口无线交换机。
</p>
<p>
   这就尴尬了，我现在只有pc是有线设备，直接接ap桥接口就好了。除此之外，买这个ap的时候，为防意外，让卖家带上了poe电源(上次翻车就是供电问题)，ap供电可以走电源。所以，那个poe交换机……
</p>
<h3 id="headline-6">
0x05 总结
</h3>
<p>
   总的来说，ubnt的方案还是非常易用的，用的这两天的感觉良好，并没有出现断流或者跳ping的情况，配合8280网卡，pc基本没有网线的需求了。相对带路由功能的k2p，还是比较实(zhuang)用(bi)的
</p>

      </article>

      

      

    </div>
  </div>
</div>
    <footer class="footer">
      <div class="p2 wrap">
        <div class="measure mt1 center">
      <nav class="social-icons icons">
<a class="fa fa-rss rss" href="/index.xml"></a>

</nav>

          <small>
            Copyright &#169; 2017<br>
            Powered by <a href="http://gohugo.io/" target="_blank">Hugo</a> &amp; <a href="https://github.com/azmelanar/hugo-theme-pixyll" target="_blank">Pixyll</a>
          </small>
        </div>
      </div>
    </footer>

    
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156425913-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

